/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "utils_auth0_js";
exports.ids = ["utils_auth0_js"];
exports.modules = {

/***/ "./utils/auth0.js":
/*!************************!*\
  !*** ./utils/auth0.js ***!
  \************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"isAuthorized\": function() { return /* binding */ isAuthorized; },\n/* harmony export */   \"authorizeUser\": function() { return /* binding */ authorizeUser; },\n/* harmony export */   \"withAuth\": function() { return /* binding */ withAuth; }\n/* harmony export */ });\n/* harmony import */ var _auth0_nextjs_auth0__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @auth0/nextjs-auth0 */ \"@auth0/nextjs-auth0\");\n/* harmony import */ var _auth0_nextjs_auth0__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_auth0_nextjs_auth0__WEBPACK_IMPORTED_MODULE_0__);\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\nconst auth0 = (0,_auth0_nextjs_auth0__WEBPACK_IMPORTED_MODULE_0__.initAuth0)({\n  domain: process.env.AUTH0_DOMAIN,\n  clientId: process.env.AUTH0_CLIENTID,\n  clientSecret: process.env.AUTH0_CLIENTSECRET,\n  scope: 'openid profile',\n  audience: process.env.AUTH0_AUDIENCE,\n  redirectUri: process.env.AUTH0_REDIRECT_URI,\n  postLogoutRedirectUri: process.env.AUTH0_POSTLOGOUT_REDIRECT_URI,\n  session: {\n    cookieSecret: process.env.AUTH0_COOKIE_SECRET,\n    storeAccessToken: true\n  }\n});\n/* harmony default export */ __webpack_exports__[\"default\"] = (auth0);\nconst isAuthorized = (user, role) => {\n  return user && user[\"https://kishonstclair.com\" + '/roles'].includes(role);\n};\nconst authorizeUser = async (req, res) => {\n  const session = await auth0.getSession(req);\n\n  if (!session || !session.user) {\n    res.writeHead(302, {\n      Location: '/api/v1/login'\n    });\n    res.end();\n    return null;\n  }\n\n  return session.user;\n};\nconst withAuth = getData => role => async ({\n  req,\n  res\n}) => {\n  const session = await auth0.getSession(req);\n\n  if (!session || !session.user || role && !isAuthorized(session.user, role)) {\n    res.writeHead(302, {\n      Location: '/api/v1/login'\n    });\n    res.end();\n    return {\n      props: {}\n    };\n  }\n\n  const data = getData ? await getData({\n    req,\n    res\n  }, session.user) : {};\n  return {\n    props: _objectSpread({\n      user: session.user\n    }, data)\n  };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9raXNob24tcG9ydGZvbGlvLXdlYnNpdGUvLi91dGlscy9hdXRoMC5qcz82YTc0Il0sIm5hbWVzIjpbImF1dGgwIiwiaW5pdEF1dGgwIiwiZG9tYWluIiwicHJvY2VzcyIsImVudiIsIkFVVEgwX0RPTUFJTiIsImNsaWVudElkIiwiQVVUSDBfQ0xJRU5USUQiLCJjbGllbnRTZWNyZXQiLCJBVVRIMF9DTElFTlRTRUNSRVQiLCJzY29wZSIsImF1ZGllbmNlIiwiQVVUSDBfQVVESUVOQ0UiLCJyZWRpcmVjdFVyaSIsIkFVVEgwX1JFRElSRUNUX1VSSSIsInBvc3RMb2dvdXRSZWRpcmVjdFVyaSIsIkFVVEgwX1BPU1RMT0dPVVRfUkVESVJFQ1RfVVJJIiwic2Vzc2lvbiIsImNvb2tpZVNlY3JldCIsIkFVVEgwX0NPT0tJRV9TRUNSRVQiLCJzdG9yZUFjY2Vzc1Rva2VuIiwiaXNBdXRob3JpemVkIiwidXNlciIsInJvbGUiLCJpbmNsdWRlcyIsImF1dGhvcml6ZVVzZXIiLCJyZXEiLCJyZXMiLCJnZXRTZXNzaW9uIiwid3JpdGVIZWFkIiwiTG9jYXRpb24iLCJlbmQiLCJ3aXRoQXV0aCIsImdldERhdGEiLCJwcm9wcyIsImRhdGEiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFHQSxNQUFNQSxLQUFLLEdBQUdDLDhEQUFTLENBQUM7QUFDdEJDLFFBQU0sRUFBRUMsT0FBTyxDQUFDQyxHQUFSLENBQVlDLFlBREU7QUFFdEJDLFVBQVEsRUFBRUgsT0FBTyxDQUFDQyxHQUFSLENBQVlHLGNBRkE7QUFHdEJDLGNBQVksRUFBRUwsT0FBTyxDQUFDQyxHQUFSLENBQVlLLGtCQUhKO0FBSXRCQyxPQUFLLEVBQUUsZ0JBSmU7QUFLdEJDLFVBQVEsRUFBRVIsT0FBTyxDQUFDQyxHQUFSLENBQVlRLGNBTEE7QUFNdEJDLGFBQVcsRUFBRVYsT0FBTyxDQUFDQyxHQUFSLENBQVlVLGtCQU5IO0FBT3RCQyx1QkFBcUIsRUFBRVosT0FBTyxDQUFDQyxHQUFSLENBQVlZLDZCQVBiO0FBUXRCQyxTQUFPLEVBQUU7QUFDUEMsZ0JBQVksRUFBRWYsT0FBTyxDQUFDQyxHQUFSLENBQVllLG1CQURuQjtBQUVQQyxvQkFBZ0IsRUFBRTtBQUZYO0FBUmEsQ0FBRCxDQUF2QjtBQWNBLCtEQUFlcEIsS0FBZjtBQUVPLE1BQU1xQixZQUFZLEdBQUcsQ0FBQ0MsSUFBRCxFQUFPQyxJQUFQLEtBQWdCO0FBQzFDLFNBQVFELElBQUksSUFBSUEsSUFBSSxDQUFDbkIsMkJBQUEsR0FBOEIsUUFBL0IsQ0FBSixDQUE2Q3FCLFFBQTdDLENBQXNERCxJQUF0RCxDQUFoQjtBQUNELENBRk07QUFJQSxNQUFNRSxhQUFhLEdBQUcsT0FBT0MsR0FBUCxFQUFZQyxHQUFaLEtBQW9CO0FBQy9DLFFBQU1WLE9BQU8sR0FBRyxNQUFNakIsS0FBSyxDQUFDNEIsVUFBTixDQUFpQkYsR0FBakIsQ0FBdEI7O0FBQ0EsTUFBSSxDQUFDVCxPQUFELElBQVksQ0FBQ0EsT0FBTyxDQUFDSyxJQUF6QixFQUErQjtBQUM3QkssT0FBRyxDQUFDRSxTQUFKLENBQWMsR0FBZCxFQUFtQjtBQUNqQkMsY0FBUSxFQUFFO0FBRE8sS0FBbkI7QUFHQUgsT0FBRyxDQUFDSSxHQUFKO0FBQ0EsV0FBTyxJQUFQO0FBQ0Q7O0FBRUQsU0FBT2QsT0FBTyxDQUFDSyxJQUFmO0FBQ0QsQ0FYTTtBQWFBLE1BQU1VLFFBQVEsR0FBR0MsT0FBTyxJQUFJVixJQUFJLElBQUksT0FBTztBQUFDRyxLQUFEO0FBQU1DO0FBQU4sQ0FBUCxLQUFzQjtBQUMvRCxRQUFNVixPQUFPLEdBQUcsTUFBTWpCLEtBQUssQ0FBQzRCLFVBQU4sQ0FBaUJGLEdBQWpCLENBQXRCOztBQUNBLE1BQUksQ0FBQ1QsT0FBRCxJQUFZLENBQUNBLE9BQU8sQ0FBQ0ssSUFBckIsSUFBOEJDLElBQUksSUFBSSxDQUFDRixZQUFZLENBQUNKLE9BQU8sQ0FBQ0ssSUFBVCxFQUFlQyxJQUFmLENBQXZELEVBQThFO0FBQzVFSSxPQUFHLENBQUNFLFNBQUosQ0FBYyxHQUFkLEVBQW1CO0FBQ2pCQyxjQUFRLEVBQUU7QUFETyxLQUFuQjtBQUdBSCxPQUFHLENBQUNJLEdBQUo7QUFDQSxXQUFPO0FBQUNHLFdBQUssRUFBRTtBQUFSLEtBQVA7QUFDRDs7QUFFRCxRQUFNQyxJQUFJLEdBQUdGLE9BQU8sR0FBRyxNQUFNQSxPQUFPLENBQUM7QUFBQ1AsT0FBRDtBQUFNQztBQUFOLEdBQUQsRUFBYVYsT0FBTyxDQUFDSyxJQUFyQixDQUFoQixHQUE2QyxFQUFqRTtBQUVBLFNBQU87QUFBQ1ksU0FBSztBQUFHWixVQUFJLEVBQUVMLE9BQU8sQ0FBQ0s7QUFBakIsT0FBMEJhLElBQTFCO0FBQU4sR0FBUDtBQUNELENBYk0iLCJmaWxlIjoiLi91dGlscy9hdXRoMC5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGluaXRBdXRoMCB9IGZyb20gJ0BhdXRoMC9uZXh0anMtYXV0aDAnO1xuXG5cbmNvbnN0IGF1dGgwID0gaW5pdEF1dGgwKHtcbiAgZG9tYWluOiBwcm9jZXNzLmVudi5BVVRIMF9ET01BSU4sXG4gIGNsaWVudElkOiBwcm9jZXNzLmVudi5BVVRIMF9DTElFTlRJRCxcbiAgY2xpZW50U2VjcmV0OiBwcm9jZXNzLmVudi5BVVRIMF9DTElFTlRTRUNSRVQsXG4gIHNjb3BlOiAnb3BlbmlkIHByb2ZpbGUnLFxuICBhdWRpZW5jZTogcHJvY2Vzcy5lbnYuQVVUSDBfQVVESUVOQ0UsXG4gIHJlZGlyZWN0VXJpOiBwcm9jZXNzLmVudi5BVVRIMF9SRURJUkVDVF9VUkksXG4gIHBvc3RMb2dvdXRSZWRpcmVjdFVyaTogcHJvY2Vzcy5lbnYuQVVUSDBfUE9TVExPR09VVF9SRURJUkVDVF9VUkksXG4gIHNlc3Npb246IHtcbiAgICBjb29raWVTZWNyZXQ6IHByb2Nlc3MuZW52LkFVVEgwX0NPT0tJRV9TRUNSRVQsXG4gICAgc3RvcmVBY2Nlc3NUb2tlbjogdHJ1ZVxuICB9LFxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IGF1dGgwO1xuXG5leHBvcnQgY29uc3QgaXNBdXRob3JpemVkID0gKHVzZXIsIHJvbGUpID0+IHtcbiAgcmV0dXJuICh1c2VyICYmIHVzZXJbcHJvY2Vzcy5lbnYuQVVUSDBfTkFNRVNQQUNFICsgJy9yb2xlcyddLmluY2x1ZGVzKHJvbGUpKTtcbn1cblxuZXhwb3J0IGNvbnN0IGF1dGhvcml6ZVVzZXIgPSBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGF1dGgwLmdldFNlc3Npb24ocmVxKTtcbiAgaWYgKCFzZXNzaW9uIHx8ICFzZXNzaW9uLnVzZXIpIHtcbiAgICByZXMud3JpdGVIZWFkKDMwMiwge1xuICAgICAgTG9jYXRpb246ICcvYXBpL3YxL2xvZ2luJ1xuICAgIH0pO1xuICAgIHJlcy5lbmQoKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHJldHVybiBzZXNzaW9uLnVzZXI7XG59XG5cbmV4cG9ydCBjb25zdCB3aXRoQXV0aCA9IGdldERhdGEgPT4gcm9sZSA9PiBhc3luYyAoe3JlcSwgcmVzfSkgPT4ge1xuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgYXV0aDAuZ2V0U2Vzc2lvbihyZXEpO1xuICBpZiAoIXNlc3Npb24gfHwgIXNlc3Npb24udXNlciB8fCAocm9sZSAmJiAhaXNBdXRob3JpemVkKHNlc3Npb24udXNlciwgcm9sZSkpKSB7XG4gICAgcmVzLndyaXRlSGVhZCgzMDIsIHtcbiAgICAgIExvY2F0aW9uOiAnL2FwaS92MS9sb2dpbidcbiAgICB9KTtcbiAgICByZXMuZW5kKCk7XG4gICAgcmV0dXJuIHtwcm9wczoge319O1xuICB9XG5cbiAgY29uc3QgZGF0YSA9IGdldERhdGEgPyBhd2FpdCBnZXREYXRhKHtyZXEsIHJlc30sIHNlc3Npb24udXNlcikgOiB7fTtcblxuICByZXR1cm4ge3Byb3BzOiB7dXNlcjogc2Vzc2lvbi51c2VyLCAuLi5kYXRhfX1cbn0iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./utils/auth0.js\n");

/***/ })

};
;