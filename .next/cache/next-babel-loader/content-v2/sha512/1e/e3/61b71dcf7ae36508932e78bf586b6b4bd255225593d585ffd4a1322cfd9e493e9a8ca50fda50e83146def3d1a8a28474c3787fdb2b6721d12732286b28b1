{"ast":null,"code":"import _regeneratorRuntime from \"/Users/kishonst.clair/Desktop/PortfolioWebsite/kishon-portfolio-website/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/kishonst.clair/Desktop/PortfolioWebsite/kishon-portfolio-website/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { initAuth0 } from '@auth0/nextjs-auth0';\nvar auth0 = initAuth0({\n  domain: process.env.AUTH0_DOMAIN,\n  clientId: process.env.AUTH0_CLIENTID,\n  clientSecret: process.env.AUTH0_CLIENTSECRET,\n  scope: 'openid profile',\n  redirectUri: process.env.AUTH0_REDIRECT_URI,\n  postLogoutRedirectUri: process.env.AUTH0_POSTLOGOUT_REDIRECT_URI,\n  session: {\n    cookieSecret: process.env.AUTH0_COOKIE_SECRET\n  }\n});\nexport default auth0;\nexport var authorizeUser = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(req, res) {\n    var session;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return auth0.getSession(req);\n\n          case 2:\n            session = _context.sent;\n\n            if (!(!session || !session.user)) {\n              _context.next = 7;\n              break;\n            }\n\n            res.writeHead(302, {\n              Location: '/api/v1/login'\n            });\n            res.end();\n            return _context.abrupt(\"return\", null);\n\n          case 7:\n            return _context.abrupt(\"return\", session.user);\n\n          case 8:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function authorizeUser(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport var withAuth = function withAuth(get) {\n  return /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(_ref2) {\n      var req, res, session;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              req = _ref2.req, res = _ref2.res;\n              _context2.next = 3;\n              return auth0.getSession(req);\n\n            case 3:\n              session = _context2.sent;\n\n              if (!(!session || !session.user)) {\n                _context2.next = 8;\n                break;\n              }\n\n              res.writeHead(302, {\n                Location: '/api/v1/login'\n              });\n              res.end();\n              return _context2.abrupt(\"return\", {\n                props: {}\n              });\n\n            case 8:\n              return _context2.abrupt(\"return\", {\n                props: {\n                  user: session.user\n                }\n              });\n\n            case 9:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function (_x3) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n};","map":{"version":3,"sources":["/Users/kishonst.clair/Desktop/PortfolioWebsite/kishon-portfolio-website/utils/auth0.js"],"names":["initAuth0","auth0","domain","process","env","AUTH0_DOMAIN","clientId","AUTH0_CLIENTID","clientSecret","AUTH0_CLIENTSECRET","scope","redirectUri","AUTH0_REDIRECT_URI","postLogoutRedirectUri","AUTH0_POSTLOGOUT_REDIRECT_URI","session","cookieSecret","AUTH0_COOKIE_SECRET","authorizeUser","req","res","getSession","user","writeHead","Location","end","withAuth","get","props"],"mappings":";;AAAA,SAASA,SAAT,QAA0B,qBAA1B;AAKA,IAAMC,KAAK,GAAGD,SAAS,CAAC;AACtBE,EAAAA,MAAM,EAAEC,OAAO,CAACC,GAAR,CAAYC,YADE;AAEtBC,EAAAA,QAAQ,EAAEH,OAAO,CAACC,GAAR,CAAYG,cAFA;AAGtBC,EAAAA,YAAY,EAAEL,OAAO,CAACC,GAAR,CAAYK,kBAHJ;AAItBC,EAAAA,KAAK,EAAE,gBAJe;AAKtBC,EAAAA,WAAW,EAAER,OAAO,CAACC,GAAR,CAAYQ,kBALH;AAMtBC,EAAAA,qBAAqB,EAAEV,OAAO,CAACC,GAAR,CAAYU,6BANb;AAOtBC,EAAAA,OAAO,EAAE;AACPC,IAAAA,YAAY,EAAEb,OAAO,CAACC,GAAR,CAAYa;AADnB;AAPa,CAAD,CAAvB;AAYA,eAAehB,KAAf;AAEA,OAAO,IAAMiB,aAAa;AAAA,sEAAG,iBAAMC,GAAN,EAAWC,GAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACLnB,KAAK,CAACoB,UAAN,CAAiBF,GAAjB,CADK;;AAAA;AACrBJ,YAAAA,OADqB;;AAAA,kBAEvB,CAACA,OAAD,IAAY,CAACA,OAAO,CAACO,IAFE;AAAA;AAAA;AAAA;;AAGzBF,YAAAA,GAAG,CAACG,SAAJ,CAAc,GAAd,EAAmB;AACjBC,cAAAA,QAAQ,EAAE;AADO,aAAnB;AAGAJ,YAAAA,GAAG,CAACK,GAAJ;AANyB,6CAOlB,IAPkB;;AAAA;AAAA,6CASpBV,OAAO,CAACO,IATY;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAbJ,aAAa;AAAA;AAAA;AAAA,GAAnB;AAYP,OAAO,IAAMQ,QAAQ,GAAG,SAAXA,QAAW,CAACC,GAAD;AAAA;AAAA,yEAAS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAOR,cAAAA,GAAP,SAAOA,GAAP,EAAYC,GAAZ,SAAYA,GAAZ;AAAA;AAAA,qBACTnB,KAAK,CAACoB,UAAN,CAAiBF,GAAjB,CADS;;AAAA;AACzBJ,cAAAA,OADyB;;AAAA,oBAE3B,CAACA,OAAD,IAAY,CAACA,OAAO,CAACO,IAFM;AAAA;AAAA;AAAA;;AAG7BF,cAAAA,GAAG,CAACG,SAAJ,CAAc,GAAd,EAAmB;AACjBC,gBAAAA,QAAQ,EAAE;AADO,eAAnB;AAGAJ,cAAAA,GAAG,CAACK,GAAJ;AAN6B,gDAOtB;AAACG,gBAAAA,KAAK,EAAE;AAAR,eAPsB;;AAAA;AAAA,gDASxB;AAACA,gBAAAA,KAAK,EAAE;AAACN,kBAAAA,IAAI,EAAEP,OAAO,CAACO;AAAf;AAAR,eATwB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAT;;AAAA;AAAA;AAAA;AAAA;AAAA,CAAjB","sourcesContent":["import { initAuth0 } from '@auth0/nextjs-auth0';\n\n\n\n\nconst auth0 = initAuth0({\n  domain: process.env.AUTH0_DOMAIN,\n  clientId: process.env.AUTH0_CLIENTID,\n  clientSecret: process.env.AUTH0_CLIENTSECRET,\n  scope: 'openid profile',\n  redirectUri: process.env.AUTH0_REDIRECT_URI,\n  postLogoutRedirectUri: process.env.AUTH0_POSTLOGOUT_REDIRECT_URI,\n  session: {\n    cookieSecret: process.env.AUTH0_COOKIE_SECRET,\n  },\n});\n\nexport default auth0\n\nexport const authorizeUser = async(req, res) => {\n  const session = await auth0.getSession(req);\n  if (!session || !session.user) {\n    res.writeHead(302, {\n      Location: '/api/v1/login'\n    });\n    res.end();\n    return null\n  }\n  return session.user \n}\n\nexport const withAuth = (get) => async({req, res}) => {\n  const session = await auth0.getSession(req);\n  if (!session || !session.user) {\n    res.writeHead(302, {\n      Location: '/api/v1/login'\n    });\n    res.end();\n    return {props: {}};\n  }\n  return {props: {user: session.user}}\n}\n\n"]},"metadata":{},"sourceType":"module"}